<!doctype html>
<html lang="pl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Strona z linkiem do Arkusza Google</title>
  <style>
    :root{ --accent:#4b8cff; --bg:#f4f7fb; --text:#222; --muted:#5b6b78; }
    body{ margin:0; font-family:Inter, Arial, sans-serif; background:var(--bg); color:var(--text); }
    .wrap{ max-width:1100px; margin:36px auto; padding:20px; }
    header{ display:flex; justify-content:space-between; align-items:center; gap:12px; }
    .menu a{ margin-right:10px; text-decoration:none; color:var(--accent); font-weight:700; }
    .panel{ background:#fff; border-radius:12px; padding:18px; box-shadow:0 8px 30px rgba(20,30,60,0.06); margin-top:18px; }
    .fancy-btn{ display:inline-block; padding:10px 14px; border-radius:10px; background:var(--accent); color:white; text-decoration:none; font-weight:700; cursor:pointer; border:0; }
    .input, input[type="url"]{ width:100%; padding:10px 12px; border-radius:8px; border:1px solid #e3e7ee; margin-top:8px; }
    label{ font-size:14px; color:var(--muted); }
    .iframe-wrap{ margin-top:12px; border-radius:8px; overflow:hidden; border:1px solid #e6e9ef; }
    iframe{ width:100%; height:600px; border:0; display:block; }
    .note{ font-size:13px; color:var(--muted); margin-top:8px; }
    footer{ margin-top:20px; font-size:13px; color:var(--muted); }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1 style="margin:0 0 6px 0">Moja Strona â€” Arkusz Google</h1>
        <div class="note">Masz problem z linkiem? Tu go naprawisz i osadzisz (jeÅ›li arkusz jest opublikowany).</div>
      </div>
      <nav class="menu">
        <!-- POWRÃ“T DO STRONY GÅÃ“WNEJ -->
        <a href="index.html" class="fancy-btn" title="PowrÃ³t do strony gÅ‚Ã³wnej">â¬… Strona gÅ‚Ã³wna</a>
      </nav>
    </header>

    <section class="panel">
      <h2 style="margin-top:0">Link do Twojego arkusza</h2>

      <!-- ---------- 1) AKTYWNY KLIKALNY LINK (otwiera w nowej karcie) ---------- -->
      <p>
        <strong>BezpoÅ›redni link (otwierany w nowej karcie):</strong><br>
        <!-- TUTAJ WPISANY JEST LINK KTÃ“RY PODAÅEÅš â€” dziaÅ‚a jako zwykÅ‚y link -->
        <a id="sheetAnchor" href="https://docs.google.com/spreadsheets/d/1Pj21m1nw7JrT9Pdvl0vyOm5ypm2oljgPmDSZrPqzilE/edit?usp=drivesdk"
           target="_blank" rel="noopener noreferrer" class="fancy-btn" style="margin-top:8px; display:inline-block;">
          ğŸ“Š OtwÃ³rz Arkusz Google (nowa karta)
        </a>
      </p>

      <!-- dodatkowy przycisk, otwierajÄ…cy link przez JS (czasem bardziej niezawodny przy sandboxach) -->
      <div style="margin-top:12px;">
        <button id="openJsBtn" class="fancy-btn">OtwÃ³rz arkusz (JS window.open)</button>
      </div>

      <hr style="margin:16px 0">

      <!-- ---------- 2) EMBED / IFRAME (DZIAÅA JEDYNIE Z LINKIEM 'publish to web') ---------- -->
      <h3>OsadÅº arkusz (iframe)</h3>
      <label for="embedLink">Wklej tutaj link do embed (Publish â†’ Embed lub link zawierajÄ…cy <code>/pubhtml</code>):</label>
      <input id="embedLink" class="input" type="url"
             placeholder="Wklej tu link z Publish to web (np. https://docs.google.com/spreadsheets/d/e/AAA.../pubhtml)">

      <div style="margin-top:8px;">
        <button id="loadEmbed" class="fancy-btn">ZaÅ‚aduj embed w stronie</button>
        <button id="hideEmbed" class="fancy-btn" style="background:#888888; margin-left:8px;">Ukryj embed</button>
      </div>

      <div id="embedContainer" class="iframe-wrap" style="display:none; margin-top:12px;">
        <iframe id="sheetIframe" src="" title="Osadzony arkusz Google"></iframe>
      </div>

      <p class="note">
        Uwaga:
        <ul>
          <li>JeÅ›li uÅ¼ywasz zwykÅ‚ego linku <code>.../edit</code>, Google zwykle blokuje osadzanie w <code>iframe</code> (nagÅ‚Ã³wek <code>X-Frame-Options</code>).</li>
          <li>Aby osadziÄ‡ arkusz, w Google Sheets wybierz: <em>File â†’ Publish to the web â†’ Embed</em> i skopiuj link zawierajÄ…cy <code>/pubhtml</code>.</li>
          <li>JeÅ›li arkusz nie jest udostÄ™pniony publicznie (Anyone with the link), klikniÄ™cie linku otworzy stronÄ™ wymagajÄ…cÄ… logowania/zgody.</li>
        </ul>
      </p>
    </section>

    <footer>
      Kilka szybkich wskazÃ³wek:
      <ol>
        <li>JeÅ›li po klikniÄ™ciu widzisz stronÄ™ â€ProÅ›ba o dostÄ™pâ€, otwÃ³rz arkusz w Google i ustaw udostÄ™pnianie na: <strong>Anyone with the link â€” Viewer</strong>.</li>
        <li>Aby osadziÄ‡ arkusz bez problemÃ³w w iframe uÅ¼yj opcji <strong>Publish to the web â†’ Embed</strong> (kopiuj link <code>/pubhtml</code>).</li>
      </ol>
    </footer>
  </div>

  <script>
    // --------- Ustawienia (zmieÅ„ tu, jeÅ›li chcesz) ----------
    const SHEET_EDIT_LINK = "https://docs.google.com/spreadsheets/d/1Pj21m1nw7JrT9Pdvl0vyOm5ypm2oljgPmDSZrPqzilE/edit?usp=drivesdk";
    // -------------------------------------------------------

    // anchor juÅ¼ w HTML uÅ¼ywa tego linku â€” dodatkowo ustawiamy go w JS (na wypadek Å‚atwej podmiany)
    document.getElementById('sheetAnchor').href = SHEET_EDIT_LINK;

    // przycisk JS open()
    document.getElementById('openJsBtn').addEventListener('click', () => {
      // otwÃ³rz w nowej karcie za pomocÄ… JS (czasami dziaÅ‚a lepiej przy wklejaniu w buttony)
      const w = window.open(SHEET_EDIT_LINK, '_blank', 'noopener');
      if(!w) {
        alert("PrzeglÄ…darka zablokowaÅ‚a otwieranie nowej karty. SprÃ³buj kliknÄ…Ä‡ bezpoÅ›rednio w link.");
      }
    });

    // Embed: Å‚adujemy podany link tylko jeÅ›li zawiera '/pubhtml'
    const embedInput = document.getElementById('embedLink');
    const loadBtn = document.getElementById('loadEmbed');
    const hideBtn = document.getElementById('hideEmbed');
    const iframe = document.getElementById('sheetIframe');
    const container = document.getElementById('embedContainer');

    loadBtn.addEventListener('click', () => {
      const val = embedInput.value.trim();
      if(!val) {
        alert('Wklej link do embed (Publish to web â†’ Embed). PrzykÅ‚ad: https://docs.google.com/spreadsheets/d/e/AAA.../pubhtml');
        return;
      }
      // prosta walidacja: link z publikacjÄ… powinien zawieraÄ‡ '/pubhtml'
      if(val.indexOf('/pubhtml') === -1) {
        // ostrzeÅ¼enie, ale pozwalamy ustawiÄ‡ â€” wiÄ™kszoÅ›Ä‡ zwykÅ‚ych /edit link bÄ™dzie zablokowana przez Google
        if(!confirm("WyglÄ…da na to, Å¼e to nie jest link 'pubhtml'. Osadzenie moÅ¼e nie zadziaÅ‚aÄ‡. Nadal wczytaÄ‡?")) {
          return;
        }
      }
      iframe.src = val;
      container.style.display = 'block';
      // scroll do iframe
      setTimeout(()=> iframe.scrollIntoView({behavior:'smooth'}), 120);
    });

    hideBtn.addEventListener('click', () => {
      iframe.src = '';
      container.style.display = 'none';
    });

    // DODATKOWA UWAGA: jeÅ›li chcesz, by pole embed byÅ‚o juÅ¼ wypeÅ‚nione przykÅ‚adowym linkiem,
    // wklej tam gotowy link z opcji "Publish to web" Google Sheets.
  </script>
</body>
</html>
